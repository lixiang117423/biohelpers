% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rda_analysis.R
\name{rda_analysis}
\alias{rda_analysis}
\title{Perform Redundancy Analysis (RDA) with environmental variables}
\usage{
rda_analysis(
  data,
  physicochemical,
  sample,
  method_decostand = "hellinger",
  scale = FALSE,
  color = "group",
  point_size = 3,
  arrow_size = 0.8,
  arrow_color = "#222222",
  arrow_alpha = 0.8,
  label_repel = TRUE,
  permutations = 999
)
}
\arguments{
\item{data}{A data frame where rows represent samples and columns represent 
species/OTUs/taxa. Should contain abundance or count data.}

\item{physicochemical}{A data frame containing environmental/physicochemical 
variables where rows represent samples and columns represent environmental 
variables. Sample names should match those in \code{data}.}

\item{sample}{A data frame containing sample information where the first 
column is 'sample' and subsequent columns contain grouping variables.}

\item{method_decostand}{Character string specifying the standardization 
method for \code{vegan::decostand()}. Default is "hellinger". Other 
options include "normalize", "standardize", "pa", "chi.square", etc.}

\item{scale}{Logical indicating whether to scale environmental variables 
in \code{vegan::rda()}. Default is FALSE.}

\item{color}{Character string specifying the column name in \code{sample} 
used for coloring points in the plot. Default is "group".}

\item{point_size}{Numeric value specifying the size of sample points. 
Default is 3.}

\item{arrow_size}{Numeric value specifying the size/length of environmental 
variable arrows. Default is 0.8.}

\item{arrow_color}{Character string specifying the color of environmental 
variable arrows. Default is "#222222".}

\item{arrow_alpha}{Numeric value between 0 and 1 for arrow transparency. 
Default is 0.8.}

\item{label_repel}{Logical indicating whether to use repelling labels for 
environmental variables to avoid overlap. Default is TRUE.}

\item{permutations}{Integer specifying the number of permutations for 
environmental fitting significance test. Default is 999.}
}
\value{
A list containing five components:
\describe{
  \item{result.rda}{The complete RDA result object from \code{vegan::rda()}, 
    which can be used for further analysis.}
  \item{plot.rda}{A ggplot object showing the RDA biplot with sample points 
    and environmental variable arrows.}
  \item{sample.scores}{A data frame containing sample coordinates on RDA axes 
    merged with sample information.}
  \item{environmental.scores}{A data frame containing environmental variable 
    coordinates for plotting arrows.}
  \item{environmental.fit}{A data frame containing RÂ² and p-values for 
    environmental variables from permutation tests.}
}
}
\description{
Perform Redundancy Analysis (RDA) to explore the relationship between 
community composition and environmental variables. RDA is a constrained 
ordination method that identifies linear combinations of environmental 
variables that best explain the variation in species composition.
}
\details{
RDA is a multivariate technique that:
\itemize{
  \item Combines regression and PCA to explore species-environment relationships
  \item Constrains ordination axes to be linear combinations of environmental variables
  \item Shows both constrained (explained by environment) and unconstrained variation
  \item Provides significance testing for environmental variables
}

The function automatically:
\itemize{
  \item Standardizes species data using the specified method
  \item Performs RDA with all environmental variables
  \item Tests environmental variable significance using permutation tests
  \item Creates a publication-ready biplot
}
}
\note{
\itemize{
  \item Data should be pre-filtered to remove rare species if needed
  \item Environmental variables should be checked for collinearity
  \item Hellinger transformation is recommended for abundance data
  \item Consider the number of environmental variables relative to sample size
}
}
\examples{
library(dplyr)
library(biohelpers)

# Load example data
data(df.rda.otu)
data(df.rda.chem)

# Prepare sample information
df.rda.chem \%>\%
  rownames() \%>\%
  as.data.frame() \%>\%
  magrittr::set_names("sample") \%>\%
  dplyr::mutate(
    group = stringr::str_split(sample, "_") \%>\% sapply("[", 1)
  ) -> df.sample

# Basic RDA analysis
rda_result <- rda_analysis(
  data = df.rda.otu,
  physicochemical = df.rda.chem, 
  sample = df.sample
)

# View the plot
rda_result$plot.rda

# Check environmental variable significance
rda_result$environmental.fit

# Customized RDA with different parameters
rda_custom <- rda_analysis(
  data = df.rda.otu,
  physicochemical = df.rda.chem,
  sample = df.sample,
  method_decostand = "standardize",
  scale = TRUE,
  color = "group",
  point_size = 4
)

# Access RDA summary statistics
summary(rda_result$result.rda)

# Check variance explained
rda_result$result.rda$CCA$eig / rda_result$result.rda$tot.chi

}
