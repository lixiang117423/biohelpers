% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cor_analysis.R
\name{cor_analysis}
\alias{cor_analysis}
\title{Calculate Correlation Coefficients and Statistical Significance}
\usage{
cor_analysis(
  data.1,
  data.2 = NULL,
  method = "pearson",
  cor = 0.6,
  pvalue = 0.05
)
}
\arguments{
\item{data.1}{First data frame where each column represents a feature/variable.
All columns should be numeric.}

\item{data.2}{Optional second data frame for cross-dataset correlation analysis.
If NULL (default), correlations are calculated within data.1. Each column
should represent a feature/variable and be numeric.}

\item{method}{Correlation method to use. Options are:
\itemize{
  \item \code{"pearson"} (default): Pearson product-moment correlation
  \item \code{"kendall"}: Kendall's tau correlation (non-parametric)
  \item \code{"spearman"}: Spearman's rank correlation (non-parametric)
}}

\item{cor}{Minimum absolute correlation coefficient threshold for filtering
results (default: 0.6). Only correlations with |r| >= cor will be returned.}

\item{pvalue}{Maximum p-value threshold for statistical significance
(default: 0.05). Only correlations with p-value <= pvalue will be returned.}
}
\value{
A data frame containing significant correlations with columns:
  \itemize{
    \item \code{from}: Variable name from the first dataset
    \item \code{to}: Variable name from the second dataset (or same dataset)
    \item \code{cor}: Correlation coefficient
    \item \code{pvalue}: Statistical significance (p-value)
  }
}
\description{
This function calculates pairwise correlations between variables within a single
dataset or between variables from two different datasets. It provides correlation
coefficients, p-values, and allows filtering based on correlation strength and
statistical significance thresholds.
}
\details{
The function uses WGCNA::corAndPvalue() for efficient correlation calculation
with significance testing. When data.2 is NULL, it performs within-dataset
correlations and excludes self-correlations (from != to). When data.2 is
provided, it performs between-dataset correlations.

The results are filtered to include only correlations that meet both the
correlation strength threshold (|cor| >= cor) and significance threshold
(p-value <= pvalue).
}
\note{
\itemize{
  \item All input data should be numeric
  \item Missing values are handled by the underlying correlation function
  \item For large datasets, consider adjusting p-value thresholds for multiple testing
}
}
\examples{
library(biohelpers)
library(dplyr)

# Example 1: Within-dataset correlation (iris features)
iris_numeric <- iris[, 1:4]

# Basic correlation analysis
cor_result1 <- cor_analysis(data.1 = iris_numeric)
print(cor_result1)

# Example 2: Custom thresholds
cor_result2 <- cor_analysis(
  data.1 = iris_numeric,
  method = "spearman",
  cor = 0.7,        # Higher correlation threshold
  pvalue = 0.01     # More stringent significance
)
print(cor_result2)

# Example 3: Between-dataset correlation
# Create two subsets of iris data
morphology <- iris[, 1:2]  # Sepal measurements  
anatomy <- iris[, 3:4]     # Petal measurements

cor_result3 <- cor_analysis(
  data.1 = morphology,
  data.2 = anatomy,
  method = "pearson"
)
print(cor_result3)

# Example 4: Using different correlation methods
# Pearson (for linear relationships)
pearson_result <- cor_analysis(iris_numeric, method = "pearson")

# Spearman (for monotonic relationships)
spearman_result <- cor_analysis(iris_numeric, method = "spearman")

# Kendall (robust to outliers)
kendall_result <- cor_analysis(iris_numeric, method = "kendall")

# Compare results
print("Pearson correlations:")
print(pearson_result)
print("Spearman correlations:")
print(spearman_result)

}
