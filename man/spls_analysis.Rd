% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spls_analysis.R
\name{spls_analysis}
\alias{spls_analysis}
\title{Perform Sparse Partial Least Squares Discriminant Analysis (sPLS-DA)}
\usage{
spls_analysis(
  data,
  group,
  ncomp = 3,
  keepX = NULL,
  scale = TRUE,
  center = TRUE,
  max_iter = 500,
  tol = 1e-06,
  validation = NULL,
  folds = 10,
  nrepeat = 5,
  verbose = TRUE
)
}
\arguments{
\item{data}{Numeric matrix or data frame with observations as rows and 
variables (features) as columns. Missing values (NAs) are allowed.}

\item{group}{A factor or character vector indicating the class membership 
for each observation. Must have the same length as the number of rows in data.}

\item{ncomp}{Positive integer specifying the number of components to include 
in the model. Default is 3.}

\item{keepX}{Numeric vector indicating the number of variables to keep in 
each component. If NULL (default), all variables are kept (non-sparse).}

\item{scale}{Logical indicating whether to scale the data. Default is TRUE.}

\item{center}{Logical indicating whether to center the data. Default is TRUE.}

\item{max_iter}{Maximum number of iterations for the algorithm. Default is 500.}

\item{tol}{Convergence tolerance for the algorithm. Default is 1e-06.}

\item{validation}{Character string specifying the validation method for 
parameter tuning. Options: "Mfold", "loo". Default is NULL (no validation).}

\item{folds}{Number of folds for cross-validation if validation is used. 
Default is 10.}

\item{nrepeat}{Number of repeats for cross-validation. Default is 5.}

\item{verbose}{Logical indicating whether to print progress information. 
Default is TRUE.}
}
\value{
A list containing six components:
\describe{
  \item{result.splsda}{The complete sPLS-DA result object from 
    \code{mixOmics::splsda()}, which can be used for further analysis.}
  \item{sample.scores}{A data frame containing sample coordinates on 
    sPLS-DA components with sample names.}
  \item{variance.explained}{A data frame containing the variance explained 
    by each component with formatted percentages and axis labels.}
  \item{variable.loadings}{A data frame containing variable loadings for 
    each component (if available).}
  \item{classification.performance}{Cross-validation performance metrics 
    (if validation was performed).}
  \item{model.parameters}{A summary of model parameters and settings used.}
}
}
\description{
Perform sparse Partial Least Squares Discriminant Analysis (sPLS-DA) for 
supervised dimension reduction and classification of high-dimensional data.
sPLS-DA is particularly useful for metabolomics, genomics, and other omics 
data where variable selection and class discrimination are important.
}
\details{
sPLS-DA combines the benefits of PLS-DA and variable selection:
\itemize{
  \item Supervised dimension reduction for classification
  \item Automatic variable selection through sparsity
  \item Handles high-dimensional data with small sample sizes
  \item Provides interpretable results with selected biomarkers
}

The function automatically:
\itemize{
  \item Validates input data and group matching
  \item Performs sPLS-DA with specified parameters  
  \item Extracts and formats key results
  \item Calculates variance explained by each component
  \item Provides ready-to-use plotting coordinates
}
}
\note{
\itemize{
  \item Groups should be balanced when possible for optimal performance
  \item Consider parameter tuning using \code{tune.splsda()} for optimal results
  \item Missing values are handled by the mixOmics package internally
  \item For large datasets, consider reducing ncomp to improve computational efficiency
}
}
\examples{
library(dplyr)
library(biohelpers)

# Load example metabolomics data
data("df.splsda.meta")
data("df.splsda.sample")

# Basic sPLS-DA analysis
splsda_result <- spls_analysis(
  data = df.splsda.meta,
  group = as.factor(df.splsda.sample$day)
)

# View sample scores
head(splsda_result$sample.scores)

# Check variance explained
splsda_result$variance.explained

# View model parameters
splsda_result$model.parameters

# Customized sPLS-DA with variable selection
splsda_sparse <- spls_analysis(
  data = df.splsda.meta,
  group = as.factor(df.splsda.sample$day),
  ncomp = 2,
  keepX = c(50, 30),  # Select 50 variables for comp1, 30 for comp2
  scale = TRUE
)

# sPLS-DA with cross-validation
splsda_cv <- spls_analysis(
  data = df.splsda.meta,
  group = as.factor(df.splsda.sample$day),
  validation = "Mfold",
  folds = 5,
  nrepeat = 3
)

# Access cross-validation results
splsda_cv$classification.performance

# Create a scatter plot
library(ggplot2)
splsda_result$sample.scores \%>\%
  dplyr::mutate(group = as.factor(df.splsda.sample$day)) \%>\%
  ggplot(aes(x = comp1, y = comp2, color = group)) +
  geom_point(size = 3, alpha = 0.8) +
  labs(
    x = splsda_result$variance.explained$label[1],
    y = splsda_result$variance.explained$label[2],
    title = "sPLS-DA Score Plot"
  ) +
  theme_minimal()

}
