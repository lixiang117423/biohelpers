% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rarefy_table.R
\name{rarefy_table}
\alias{rarefy_table}
\title{Perform rarefaction to standardize sampling depth across samples}
\usage{
rarefy_table(
  data,
  value = NULL,
  seed = 123,
  min_reads = 1000,
  remove_empty = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{data}{Community data matrix where rows represent samples and columns 
represent species/OTUs/taxa. The data should contain count data (integers).}

\item{value}{Subsample size for rarefying community. Can be:
\itemize{
  \item NULL (default): Uses the minimum row sum across all samples
  \item Single numeric value: Same rarefaction depth for all samples  
  \item Numeric vector: Different rarefaction depth for each sample
}}

\item{seed}{Integer value for setting random seed to ensure reproducible 
results. Default is 123.}

\item{min_reads}{Minimum number of reads required for a sample to be included 
in rarefaction. Samples with fewer reads will be removed. Default is 1000.}

\item{remove_empty}{Logical indicating whether to remove taxa (columns) that 
become absent after rarefaction. Default is TRUE.}

\item{verbose}{Logical indicating whether to print progress information. 
Default is TRUE.}
}
\value{
A list containing four components:
\describe{
  \item{data.rarefied}{A data frame containing the rarefied community matrix 
    with the same structure as input but standardized sampling depth.}
  \item{rarefaction.info}{A summary data frame with original and rarefied 
    read counts, number of taxa, and other statistics for each sample.}
  \item{removed.samples}{Character vector of sample names that were removed 
    due to insufficient reads (if any).}
  \item{rarefaction.depth}{The actual rarefaction depth used for analysis.}
}
}
\description{
Perform rarefaction analysis to standardize the sampling depth across all 
samples in a community data matrix. This is essential for comparing diversity 
metrics across samples with different sequencing depths in microbiome studies.
}
\details{
Rarefaction randomly subsamples reads from each sample to a standardized depth,
enabling fair comparison of diversity metrics across samples. The function:
\itemize{
  \item Removes samples with insufficient reads (below min_reads)
  \item Performs random subsampling using vegan::rrarefy()
  \item Optionally removes taxa that become absent after rarefaction
  \item Provides comprehensive summary statistics
}
}
\note{
\itemize{
  \item Input data should be raw count data (not relative abundances)
  \item Rarefaction involves random sampling, so results may vary between runs 
    unless seed is set
  \item Consider the trade-off between retaining samples and rarefaction depth
  \item Some studies prefer alternative normalization methods to rarefaction
}
}
\examples{
library(dplyr)
library(biohelpers)

# Load example microbiome data
data(df.permanova.otu)

# Basic rarefaction using minimum sample depth
rarefy_result <- rarefy_table(data = df.permanova.otu)

# View rarefied data
head(rarefy_result$data.rarefied)

# Check rarefaction summary
rarefy_result$rarefaction.info

# Custom rarefaction depth
rarefy_custom <- rarefy_table(
  data = df.permanova.otu,
  value = 5000,
  seed = 456
)

# Check rarefaction depth used
rarefy_custom$rarefaction.depth

# Multiple rarefaction depths (if you have multiple sample types)
# rarefy_multi <- rarefy_table(
#   data = df.permanova.otu,
#   value = c(rep(3000, 5), rep(4000, 4))  # Different depths per sample
# )

# Transpose data if needed (samples as columns, taxa as rows)
df.permanova.otu \%>\%
  t() \%>\%
  as.data.frame() \%>\%
  rarefy_table(value = 3000) -> df.transposed.rarefied

}
