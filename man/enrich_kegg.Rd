% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrich_kegg.R
\name{enrich_kegg}
\alias{enrich_kegg}
\title{Perform KEGG Pathway Enrichment Analysis}
\usage{
enrich_kegg(
  gene,
  kegg.db,
  pAdjustMethod = "BH",
  p.adjust = 0.05,
  min.pathway.size = 3,
  max.pathway.size = 500
)
}
\arguments{
\item{gene}{Character vector containing gene identifiers (e.g., gene symbols,
Entrez IDs, Ensembl IDs, or other identifiers) that correspond to 
differentially expressed genes for pathway enrichment analysis}

\item{kegg.db}{Data frame containing KEGG pathway annotation information.
Must include the following columns:
\itemize{
  \item \code{gene}: Gene identifiers matching those in the gene parameter
  \item \code{kegg.id}: KEGG pathway identifiers (e.g., "hsa04110", "map00010")
  \item \code{kegg.term}: KEGG pathway descriptions (e.g., "Cell cycle", "Glycolysis")
  \item \code{kegg.category}: Optional. KEGG pathway categories (e.g., "Metabolism", "Signaling")
}}

\item{pAdjustMethod}{Method for multiple testing correction. Options include:
\itemize{
  \item \code{"BH"} (default): Benjamini-Hochberg false discovery rate
  \item \code{"bonferroni"}: Bonferroni correction (most conservative)
  \item \code{"holm"}: Holm's step-down procedure
  \item \code{"hochberg"}: Hochberg's procedure
  \item \code{"hommel"}: Hommel's procedure
  \item \code{"BY"}: Benjamini-Yekutieli procedure
  \item \code{"fdr"}: Synonym for "BH"
  \item \code{"none"}: No correction (not recommended)
}}

\item{p.adjust}{Significance threshold for adjusted p-values (default: 0.05).
Only KEGG pathways with adjusted p-values below this threshold will be returned}

\item{min.pathway.size}{Minimum number of genes required in a pathway for testing
(default: 3). Pathways with fewer genes will be excluded from analysis}

\item{max.pathway.size}{Maximum number of genes allowed in a pathway for testing
(default: 500). Very large pathways can be excluded to focus on specific processes}
}
\value{
A data frame containing pathway enrichment results with columns:
  \itemize{
    \item \code{ID}: KEGG pathway identifier
    \item \code{Description}: KEGG pathway description/name
    \item \code{GeneRatio}: Proportion of input genes in this pathway (numeric)
    \item \code{BgRatio}: Proportion of background genes in this pathway
    \item \code{pvalue}: Raw p-value from hypergeometric test
    \item \code{p.adjust}: Adjusted p-value using specified method
    \item \code{qvalue}: Q-value (if calculated)
    \item \code{geneID}: Gene identifiers contributing to this pathway (separated by "/")
    \item \code{Count}: Number of input genes in this pathway
    \item \code{gene.count}: Number of input genes in this pathway
    \item \code{total.genes}: Total number of input genes tested
    \item \code{enrichment.score}: -log10(p.adjust) for visualization
  }
}
\description{
This function performs KEGG (Kyoto Encyclopedia of Genes and Genomes) pathway
enrichment analysis on a set of differentially expressed genes using a custom
KEGG annotation database. It identifies significantly over-represented metabolic
and signaling pathways and calculates enrichment statistics with multiple
testing correction.
}
\details{
This function uses clusterProfiler to perform over-representation analysis (ORA)
based on the hypergeometric distribution. The analysis tests whether genes in
your input list are significantly over-represented in specific KEGG pathways
compared to what would be expected by chance.

KEGG pathways provide insight into:
\itemize{
  \item Metabolic processes and biochemical reactions
  \item Signal transduction cascades
  \item Cellular processes and regulation
  \item Disease-associated pathways
  \item Drug metabolism and interactions
}

The function automatically converts character-based GeneRatio to numeric format
and adds an enrichment score for easier interpretation and visualization.
}
\note{
\itemize{
  \item Ensure gene identifiers in your list match those in the KEGG database
  \item KEGG pathway annotations may vary between organisms
  \item Consider pathway size when interpreting results (very large pathways may be less specific)
  \item For human data, common KEGG ID formats are "hsa" prefixed (e.g., "hsa04110")
}
}
\examples{
library(biohelpers)
library(dplyr)

# Example 1: Basic KEGG pathway enrichment
\dontrun{
# Load required data (assumes these datasets exist)
data(df.rnaseq.kegg)   # KEGG annotation database
data(df.rnaseq.degs)   # Differentially expressed genes

# Basic pathway enrichment analysis
kegg_results <- enrich_kegg(
  gene = df.rnaseq.degs$gene,
  kegg.db = df.rnaseq.kegg
)

print(head(kegg_results))
print(paste("Found", nrow(kegg_results), "enriched pathways"))

# View top enriched pathways
top_pathways <- head(kegg_results, 10)
print(top_pathways[, c("ID", "Description", "pvalue", "p.adjust", "Count")])
}

# Example 2: Stringent analysis parameters
\dontrun{
# More conservative analysis
kegg_strict <- enrich_kegg(
  gene = df.rnaseq.degs$gene,
  kegg.db = df.rnaseq.kegg,
  pAdjustMethod = "bonferroni",
  p.adjust = 0.01,
  min.pathway.size = 5,
  max.pathway.size = 200
)

print(paste("Strict analysis found", nrow(kegg_strict), "pathways"))
}

# Example 3: Creating a KEGG database format
# This demonstrates the required structure for kegg.db parameter
sample_kegg_db <- data.frame(
  gene = c("GENE1", "GENE2", "GENE3", "GENE1", "GENE4", "GENE5", "GENE6"),
  kegg.id = c("hsa04110", "hsa04110", "hsa04110", "hsa00010", "hsa00010", "hsa04210", "hsa04210"),
  kegg.term = c("Cell cycle", "Cell cycle", "Cell cycle",
                "Glycolysis / Gluconeogenesis", "Glycolysis / Gluconeogenesis",
                "Apoptosis", "Apoptosis"),
  kegg.category = c("Cell Growth and Death", "Cell Growth and Death", "Cell Growth and Death",
                    "Metabolism", "Metabolism", "Cell Growth and Death", "Cell Growth and Death")
)

sample_genes <- c("GENE1", "GENE2", "GENE4", "GENE6")

\dontrun{
# Run pathway analysis with sample data
sample_results <- enrich_kegg(
  gene = sample_genes,
  kegg.db = sample_kegg_db,
  p.adjust = 1.0  # Accept all pathways for demonstration
)
print(sample_results)
}

# Example 4: Filter by pathway categories
\dontrun{
# Focus on metabolic pathways only
metabolism_kegg <- df.rnaseq.kegg \%>\%
  filter(grepl("Metabolism", kegg.category, ignore.case = TRUE))

metabolism_results <- enrich_kegg(
  gene = df.rnaseq.degs$gene,
  kegg.db = metabolism_kegg,
  pAdjustMethod = "BH"
)

print(paste("Metabolic pathways enriched:", nrow(metabolism_results)))

# Focus on signaling pathways
signaling_kegg <- df.rnaseq.kegg \%>\%
  filter(grepl("Signal|Signaling", kegg.category, ignore.case = TRUE))

signaling_results <- enrich_kegg(
  gene = df.rnaseq.degs$gene,
  kegg.db = signaling_kegg
)

print(paste("Signaling pathways enriched:", nrow(signaling_results)))
}

# Example 5: Visualization preparation
\dontrun{
# Prepare data for plotting
kegg_for_plot <- kegg_results \%>\%
  arrange(desc(enrichment.score)) \%>\%
  head(15) \%>\%
  mutate(
    pathway_short = ifelse(nchar(Description) > 40,
                          paste0(substr(Description, 1, 37), "..."),
                          Description)
  )

# The results are ready for ggplot2 visualization
print("Data prepared for pathway visualization")
print(kegg_for_plot[, c("ID", "pathway_short", "enrichment.score", "Count")])
}

}
\seealso{
\itemize{
  \item \code{\link{enrich_go}} for Gene Ontology enrichment analysis
  \item \code{\link{find_degs_deseq2}} for differential expression analysis
}
}
